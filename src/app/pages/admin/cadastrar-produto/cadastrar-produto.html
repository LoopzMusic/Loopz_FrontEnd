<div class="dashboard-container d-flex">
  <!-- Componente Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <main class="main-content flex-grow-1 p-4 p-md-5 bg-light-gray minimized">
    <header class="page-header d-flex justify-content-between align-items-center mb-4">
      <h1 class="fs-3 fw-bold text-dark-gray">{{ isEdicao ? 'Editar' : 'Cadastrar' }} Produto</h1>
    </header>

    <!-- Formulário -->
    <div class="card shadow-sm border-0 rounded-3">
      <div class="card-body p-4">
        <h5 class="card-title fs-5 fw-bold text-dark-gray mb-4 border-bottom pb-2">Informações do Produto</h5>
        
        <form [formGroup]="produtoForm" (ngSubmit)="onSubmit()">
          <!-- Nome do Produto -->
          <div class="mb-3">
            <label for="nomeProduto" class="form-label">
              Nome do Produto <span class="text-danger">*</span>
            </label>
            <input 
              type="text" 
              class="form-control" 
              id="nomeProduto"
              formControlName="nomeProduto"
              placeholder="Ex: Violão Clássico Loopz"
              [class.is-invalid]="isFieldInvalid('nomeProduto')">
            <div class="invalid-feedback" *ngIf="isFieldInvalid('nomeProduto')">
              Nome do produto é obrigatório
            </div>
          </div>

          <div class="row">
            <!-- Preço -->
            <div class="col-md-6 mb-3">
              <label for="preco" class="form-label">
                Preço (R$) <span class="text-danger">*</span>
              </label>
              <input 
                type="number" 
                class="form-control" 
                id="preco"
                formControlName="preco"
                placeholder="899.90"
                step="0.01"
                [class.is-invalid]="isFieldInvalid('preco')">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('preco')">
                Preço é obrigatório
              </div>
            </div>

            <!-- Quantidade em Estoque -->
            <div class="col-md-6 mb-3">
              <label for="quantidadeEstoque" class="form-label">
                Quantidade em Estoque <span class="text-danger">*</span>
              </label>
              <input 
                type="number" 
                class="form-control" 
                id="quantidadeEstoque"
                formControlName="quantidadeEstoque"
                placeholder="15"
                [class.is-invalid]="isFieldInvalid('quantidadeEstoque')">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('quantidadeEstoque')">
                Quantidade é obrigatória
              </div>
            </div>
          </div>

          <div class="row">
            <!-- Marca -->
            <div class="col-md-6 mb-3">
              <label for="marca" class="form-label">
                Marca <span class="text-danger">*</span>
              </label>
              <input 
                type="text" 
                class="form-control" 
                id="marca"
                formControlName="marca"
                placeholder="Loopz"
                [class.is-invalid]="isFieldInvalid('marca')">
              <div class="invalid-feedback" *ngIf="isFieldInvalid('marca')">
                Marca é obrigatória
              </div>
            </div>

            <!-- Categoria -->
            <div class="col-md-6 mb-3">
              <label for="categoria" class="form-label">
                Categoria <span class="text-danger">*</span>
              </label>
              <select 
                class="form-select" 
                id="categoria"
                formControlName="categoria"
                [class.is-invalid]="isFieldInvalid('categoria')">
                <option value="" selected>Selecione...</option>
                <option value="cordas">Instrumentos de Cordas</option>
                <option value="teclas">Instrumentos de Teclas</option>
                <option value="percussao">Instrumentos de Percussão</option>
                <option value="sopro">Instrumentos de Sopro</option>
                <option value="eletronicos">Instrumentos Eletrônicos</option>
                <option value="acessorios">Acessórios</option>
              </select>
              <div class="invalid-feedback" *ngIf="isFieldInvalid('categoria')">
                Categoria é obrigatória
              </div>
            </div>
          </div>

          <div class="row">
            <!-- Material -->
            <div class="col-md-6 mb-3">
              <label for="material" class="form-label">Material</label>
              <input 
                type="text" 
                class="form-control" 
                id="material"
                formControlName="material"
                placeholder="Cedro e Mogno">
            </div>

            <!-- Cor -->
            <div class="col-md-6 mb-3">
              <label for="cor" class="form-label">Cor</label>
              <input 
                type="text" 
                class="form-control" 
                id="cor"
                formControlName="cor"
                placeholder="Natural">
            </div>
          </div>

          <!-- Descrição -->
          <div class="mb-3">
            <label for="descricao" class="form-label">Descrição</label>
            <textarea 
              class="form-control" 
              id="descricao"
              formControlName="descricao"
              rows="4"
              placeholder="Descrição detalhada do produto..."></textarea>
          </div>

          <!-- Imagem do Produto -->
          <div class="mb-4">
            <label for="imagemProduto" class="form-label">Imagem do Produto</label>
            <input 
              class="form-control" 
              type="file" 
              id="imagemProduto"
              (change)="onFileSelected($event)"
              accept="image/*">
            <div class="form-text">
              {{ imagemSelecionada ? imagemSelecionada : 'Nenhum arquivo escolhido' }}
            </div>
          </div>

          <!-- Botões -->
          <div class="d-flex gap-3">
            <button 
              type="submit" 
              class="btn btn-primary px-4"
              [disabled]="loading">
              <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
              Cadastrar Produto
            </button>
            <button 
              type="button" 
              class="btn btn-outline-secondary px-4"
              (click)="onCancelar()">
              Cancelar
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>